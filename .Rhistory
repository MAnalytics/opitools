idx <- xx
i<-2
idx[i-1]
xx <-round(nrow(freq_by_rank)/10, digit=0) - 2
#create sequence
idx <- xx
for(i in 2:seq_len(10)){#i<-2
idx <- c(idx, idx[i-1] + xx)
}
xx
idx[i-1]
idx
xx <-round(nrow(freq_by_rank)/10, digit=0) - 2
#create sequence
idx <- xx
xx <-round(nrow(freq_by_rank)/10, digit=0) - 2
#create sequence
idx <- xx
for(i in 2:seq_len(10)){#i<-2
idx <- c(idx, idx[i-1] + xx)
flush.console()
print(i)
}
xx <-round(nrow(freq_by_rank)/10, digit=0) - 2
#create sequence
idx <- xx
idx
idx[i-1]
idx
i
i<-2
2:seq_len(10)
seq_len(10)
xx <-round(nrow(freq_by_rank)/10, digit=0) - 2
#create sequence
idx <- xx
for(i in 2:10){#i<-2
idx <- rbind(idx, idx[i-1] + xx)
flush.console()
print(i)
}
idx
nrow(freq_by_rank)
ggplot(freq_by_rank, aes(rank, term_freq,
color="Log(freq) vs. Log(r)")) +
geom_line(size = 1.6, alpha = 0.8, colour="red") +
geom_point() +
labs(title="Checking text document against Zipf's law")+
scale_x_log10() +
scale_y_log10() +
xlab("log(Rank)") +
ylab("log(Term frequency)")+
#theme(legend.position = "top")
geom_abline(intercept = as.numeric(int_slope$coefficients[1]),
slope = as.numeric(int_slope$coefficients[2]),
color = c("gray40"), linetype = 2, size=1.2) +
theme_light()+
scale_shape_manual(values = 1) +
labs(shape = "", linetype = "") +
theme(panel.border = element_rect(colour = "black", fill=NA),
aspect.ratio = 1, axis.text = element_text(colour = 1, size = 12))
ggplot(freq_by_rank, aes(rank, term_freq,
color="Log(freq) vs. Log(r)")) +
geom_line(size = 1.6, alpha = 0.8, colour="red") +
geom_point(colour="black") +
labs(title="Checking text document against Zipf's law")+
scale_x_log10() +
scale_y_log10() +
xlab("log(Rank)") +
ylab("log(Term frequency)")+
#theme(legend.position = "top")
geom_abline(intercept = as.numeric(int_slope$coefficients[1]),
slope = as.numeric(int_slope$coefficients[2]),
color = c("gray40"), linetype = 2, size=1.2) +
theme_light()+
scale_shape_manual(values = 1) +
labs(shape = "", linetype = "") +
theme(panel.border = element_rect(colour = "black", fill=NA),
aspect.ratio = 1, axis.text = element_text(colour = 1, size = 12))
ggplot(freq_by_rank, aes(rank, term_freq,
color="Log(freq) vs. Log(r)")) +
geom_line(size = 1.6, alpha = 0.8, colour="red") +
geom_point(colour="") +
labs(title="Checking text document against Zipf's law")+
scale_x_log10() +
scale_y_log10() +
xlab("log(Rank)") +
ylab("log(Term frequency)")+
#theme(legend.position = "top")
geom_abline(intercept = as.numeric(int_slope$coefficients[1]),
slope = as.numeric(int_slope$coefficients[2]),
color = c("gray40"), linetype = 2, size=1.2) +
theme_light()+
scale_shape_manual(values = 1) +
labs(shape = "", linetype = "") +
theme(panel.border = element_rect(colour = "black", fill=NA),
aspect.ratio = 1, axis.text = element_text(colour = 1, size = 12))
ggplot(freq_by_rank, aes(rank, term_freq,
color="Log(freq) vs. Log(r)")) +
geom_line(size = 1.6, alpha = 0.8, colour="red") +
geom_point(alpha=0.05) +
labs(title="Checking text document against Zipf's law")+
scale_x_log10() +
scale_y_log10() +
xlab("log(Rank)") +
ylab("log(Term frequency)")+
#theme(legend.position = "top")
geom_abline(intercept = as.numeric(int_slope$coefficients[1]),
slope = as.numeric(int_slope$coefficients[2]),
color = c("gray40"), linetype = 2, size=1.2) +
theme_light()+
scale_shape_manual(values = 1) +
labs(shape = "", linetype = "") +
theme(panel.border = element_rect(colour = "black", fill=NA),
aspect.ratio = 1, axis.text = element_text(colour = 1, size = 12))
ggplot(freq_by_rank, aes(rank, term_freq,
color="Log(freq) vs. Log(r)")) +
geom_line(size = 1.6, alpha = 0.8, colour="red") +
geom_point(alpha=1) +
labs(title="Checking text document against Zipf's law")+
scale_x_log10() +
scale_y_log10() +
xlab("log(Rank)") +
ylab("log(Term frequency)")+
#theme(legend.position = "top")
geom_abline(intercept = as.numeric(int_slope$coefficients[1]),
slope = as.numeric(int_slope$coefficients[2]),
color = c("gray40"), linetype = 2, size=1.2) +
theme_light()+
scale_shape_manual(values = 1) +
labs(shape = "", linetype = "") +
theme(panel.border = element_rect(colour = "black", fill=NA),
aspect.ratio = 1, axis.text = element_text(colour = 1, size = 12))
ggplot(freq_by_rank, aes(rank, term_freq,
color="Log(freq) vs. Log(r)")) +
geom_line(size = 1.6, alpha = 0.8, colour="red") +
geom_point(alpha=0.5) +
labs(title="Checking text document against Zipf's law")+
scale_x_log10() +
scale_y_log10() +
xlab("log(Rank)") +
ylab("log(Term frequency)")+
#theme(legend.position = "top")
geom_abline(intercept = as.numeric(int_slope$coefficients[1]),
slope = as.numeric(int_slope$coefficients[2]),
color = c("gray40"), linetype = 2, size=1.2) +
theme_light()+
scale_shape_manual(values = 1) +
labs(shape = "", linetype = "") +
theme(panel.border = element_rect(colour = "black", fill=NA),
aspect.ratio = 1, axis.text = element_text(colour = 1, size = 12))
ggplot(freq_by_rank, aes(rank, term_freq,
color="Log(freq) vs. Log(r)")) +
geom_line(size = 1.6, alpha = 0.8, colour="red") +
geom_point(colour="red", alpha=0.5) +
labs(title="Checking text document against Zipf's law")+
scale_x_log10() +
scale_y_log10() +
xlab("log(Rank)") +
ylab("log(Term frequency)")+
#theme(legend.position = "top")
geom_abline(intercept = as.numeric(int_slope$coefficients[1]),
slope = as.numeric(int_slope$coefficients[2]),
color = c("gray40"), linetype = 2, size=1.2) +
theme_light()+
scale_shape_manual(values = 1) +
labs(shape = "", linetype = "") +
theme(panel.border = element_rect(colour = "black", fill=NA),
aspect.ratio = 1, axis.text = element_text(colour = 1, size = 12))
ggplot(freq_by_rank, aes(rank, term_freq,
color="Log(freq) vs. Log(r)")) +
geom_line(size = 1.6, alpha = 0.8, colour="red") +
geom_point(colour="red", alpha=0.5, size=1.5) +
labs(title="Checking text document against Zipf's law")+
scale_x_log10() +
scale_y_log10() +
xlab("log(Rank)") +
ylab("log(Term frequency)")+
#theme(legend.position = "top")
geom_abline(intercept = as.numeric(int_slope$coefficients[1]),
slope = as.numeric(int_slope$coefficients[2]),
color = c("gray40"), linetype = 2, size=1.2) +
theme_light()+
scale_shape_manual(values = 1) +
labs(shape = "", linetype = "") +
theme(panel.border = element_rect(colour = "black", fill=NA),
aspect.ratio = 1, axis.text = element_text(colour = 1, size = 12))
ggplot(freq_by_rank, aes(rank, term_freq,
color="Log(freq) vs. Log(r)")) +
geom_line(size = 1.6, alpha = 0.8, colour="red") +
geom_point(colour="red", alpha=0.5, size=2.5) +
labs(title="Checking text document against Zipf's law")+
scale_x_log10() +
scale_y_log10() +
xlab("log(Rank)") +
ylab("log(Term frequency)")+
#theme(legend.position = "top")
geom_abline(intercept = as.numeric(int_slope$coefficients[1]),
slope = as.numeric(int_slope$coefficients[2]),
color = c("gray40"), linetype = 2, size=1.2) +
theme_light()+
scale_shape_manual(values = 1) +
labs(shape = "", linetype = "") +
theme(panel.border = element_rect(colour = "black", fill=NA),
aspect.ratio = 1, axis.text = element_text(colour = 1, size = 12))
ggplot(freq_by_rank, aes(rank, term_freq,
color="Log(freq) vs. Log(r)")) +
geom_line(size = 1.6, alpha = 0.8, colour="red") +
geom_point(colour="red", alpha=0.5, size=1) +
labs(title="Checking text document against Zipf's law")+
scale_x_log10() +
scale_y_log10() +
xlab("log(Rank)") +
ylab("log(Term frequency)")+
#theme(legend.position = "top")
geom_abline(intercept = as.numeric(int_slope$coefficients[1]),
slope = as.numeric(int_slope$coefficients[2]),
color = c("gray40"), linetype = 2, size=1.2) +
theme_light()+
scale_shape_manual(values = 1) +
labs(shape = "", linetype = "") +
theme(panel.border = element_rect(colour = "black", fill=NA),
aspect.ratio = 1, axis.text = element_text(colour = 1, size = 12))
ggplot(freq_by_rank, aes(rank, term_freq,
color="Log(freq) vs. Log(r)")) +
geom_line(size = 1.6, alpha = 0.8, colour="red") +
geom_point(colour="red", alpha=0.8, size=1) +
labs(title="Checking text document against Zipf's law")+
scale_x_log10() +
scale_y_log10() +
xlab("log(Rank)") +
ylab("log(Term frequency)")+
#theme(legend.position = "top")
geom_abline(intercept = as.numeric(int_slope$coefficients[1]),
slope = as.numeric(int_slope$coefficients[2]),
color = c("gray40"), linetype = 2, size=1.2) +
theme_light()+
scale_shape_manual(values = 1) +
labs(shape = "", linetype = "") +
theme(panel.border = element_rect(colour = "black", fill=NA),
aspect.ratio = 1, axis.text = element_text(colour = 1, size = 12))
ggplot(freq_by_rank, aes(rank, term_freq,
color="Log(freq) vs. Log(r)")) +
geom_line(size = 1.6, alpha = 0.8, colour="red") +
geom_point(colour="red", alpha=0, size=1) +
labs(title="Checking text document against Zipf's law")+
scale_x_log10() +
scale_y_log10() +
xlab("log(Rank)") +
ylab("log(Term frequency)")+
#theme(legend.position = "top")
geom_abline(intercept = as.numeric(int_slope$coefficients[1]),
slope = as.numeric(int_slope$coefficients[2]),
color = c("gray40"), linetype = 2, size=1.2) +
theme_light()+
scale_shape_manual(values = 1) +
labs(shape = "", linetype = "") +
theme(panel.border = element_rect(colour = "black", fill=NA),
aspect.ratio = 1, axis.text = element_text(colour = 1, size = 12))
idx
as.vector(idx)
idx <- as.vector(idx)
mtcars$name <- row.names(mtcars)
p <- ggplot(mtcars, aes(wt, mpg))
p + geom_point()
p + geom_point() +
geom_text(data=subset(mtcars, wt > 4 | mpg > 25),
aes(wt,mpg,label=name))
subset(mtcars, wt > 4 | mpg > 25)
freq_by_rank[idx,]
ggplot(freq_by_rank, aes(rank, term_freq,
color="Log(freq) vs. Log(r)")) +
geom_line(size = 1.6, alpha = 0.8, colour="red") +
geom_point(colour="red", alpha=0, size=1) +
geom_text(data=freq_by_rank[idx,],
aes(rank, term_freq,label=name))
labs(title="Checking text document against Zipf's law")+
scale_x_log10() +
scale_y_log10() +
xlab("log(Rank)") +
ylab("log(Term frequency)")+
#theme(legend.position = "top")
geom_abline(intercept = as.numeric(int_slope$coefficients[1]),
slope = as.numeric(int_slope$coefficients[2]),
color = c("gray40"), linetype = 2, size=1.2) +
theme_light()+
scale_shape_manual(values = 1) +
labs(shape = "", linetype = "") +
theme(panel.border = element_rect(colour = "black", fill=NA),
aspect.ratio = 1, axis.text = element_text(colour = 1, size = 12))
ggplot(freq_by_rank, aes(rank, term_freq,
color="Log(freq) vs. Log(r)")) +
geom_line(size = 1.6, alpha = 0.8, colour="red") +
geom_point(colour="red", alpha=0, size=1) +
geom_text(data=freq_by_rank[idx,],
aes(rank, term_freq,label=name))+
labs(title="Checking text document against Zipf's law")+
scale_x_log10() +
scale_y_log10() +
xlab("log(Rank)") +
ylab("log(Term frequency)")+
#theme(legend.position = "top")
geom_abline(intercept = as.numeric(int_slope$coefficients[1]),
slope = as.numeric(int_slope$coefficients[2]),
color = c("gray40"), linetype = 2, size=1.2) +
theme_light()+
scale_shape_manual(values = 1) +
labs(shape = "", linetype = "") +
theme(panel.border = element_rect(colour = "black", fill=NA),
aspect.ratio = 1, axis.text = element_text(colour = 1, size = 12))
head(freq_by_rank)
ggplot(freq_by_rank, aes(rank, term_freq,
color="Log(freq) vs. Log(r)")) +
geom_line(size = 1.6, alpha = 0.8, colour="red") +
geom_point(colour="red", alpha=0, size=1) +
geom_text(data=freq_by_rank[idx,],
aes(rank, term_freq,label=word))+
labs(title="Checking text document against Zipf's law")+
scale_x_log10() +
scale_y_log10() +
xlab("log(Rank)") +
ylab("log(Term frequency)")+
#theme(legend.position = "top")
geom_abline(intercept = as.numeric(int_slope$coefficients[1]),
slope = as.numeric(int_slope$coefficients[2]),
color = c("gray40"), linetype = 2, size=1.2) +
theme_light()+
scale_shape_manual(values = 1) +
labs(shape = "", linetype = "") +
theme(panel.border = element_rect(colour = "black", fill=NA),
aspect.ratio = 1, axis.text = element_text(colour = 1, size = 12))
ggplot(freq_by_rank, aes(rank, term_freq,
color="Log(freq) vs. Log(r)")) +
geom_line(size = 1.6, alpha = 0.8, colour="red") +
geom_point(colour="red", alpha=0, size=1) +
geom_text(data=freq_by_rank[idx,],
aes(rank, term_freq,label=word))+
labs(title="Checking text document against Zipf's law")+
scale_x_log10() +
scale_y_log10()
#plot to first get x labels
get_x <- ggplot(freq_by_rank, aes(rank, term_freq,
color="Log(freq) vs. Log(r)")) +
geom_line(size = 1.6, alpha = 0.8, colour="red") +
geom_point(colour="red", alpha=0, size=1) +
geom_text(data=freq_by_rank[idx,],
aes(rank, term_freq,label=word))+
labs(title="Checking text document against Zipf's law")+
scale_x_log10() +
scale_y_log10()
ggplot_build(get_x)$layout$panel_params[[1]]$x$get_labels()
get_x[!is.na(get_x)]
get_x
get_x <- ggplot_build(get_x)$layout$panel_params[[1]]$x$get_labels()
get_x[!is.na(get_x)]
get_x <- get_x[!is.na(get_x)]
as.numeric(get_x[!is.na(get_x)])
get_x <- as.numeric(get_x[!is.na(get_x)])
ggplot(freq_by_rank, aes(rank, term_freq,
color="Log(freq) vs. Log(r)")) +
geom_line(size = 1.6, alpha = 0.8, colour="red") +
geom_point(colour="red", alpha=0, size=1) +
geom_text(data=freq_by_rank[get_x,],
aes(rank, term_freq,label=word))+
labs(title="Checking text document against Zipf's law")+
scale_x_log10() +
scale_y_log10() +
xlab("log(Rank)") +
ylab("log(Term frequency)")+
#theme(legend.position = "top")
geom_abline(intercept = as.numeric(int_slope$coefficients[1]),
slope = as.numeric(int_slope$coefficients[2]),
color = c("gray40"), linetype = 2, size=1.2) +
theme_light()+
scale_shape_manual(values = 1) +
labs(shape = "", linetype = "") +
theme(panel.border = element_rect(colour = "black", fill=NA),
aspect.ratio = 1, axis.text = element_text(colour = 1, size = 12))
ggplot(freq_by_rank, aes(rank, term_freq,
color="Log(freq) vs. Log(r)")) +
geom_line(size = 1.6, alpha = 0.8, colour="red") +
geom_point(colour="red", alpha=0, size=1) +
geom_text(data=freq_by_rank[get_x,],
aes(rank, term_freq,label=word, colour="black"))+
labs(title="Checking text document against Zipf's law")+
scale_x_log10() +
scale_y_log10() +
xlab("log(Rank)") +
ylab("log(Term frequency)")+
#theme(legend.position = "top")
geom_abline(intercept = as.numeric(int_slope$coefficients[1]),
slope = as.numeric(int_slope$coefficients[2]),
color = c("gray40"), linetype = 2, size=1.2) +
theme_light()+
scale_shape_manual(values = 1) +
labs(shape = "", linetype = "") +
theme(panel.border = element_rect(colour = "black", fill=NA),
aspect.ratio = 1, axis.text = element_text(colour = 1, size = 12))
ggplot(freq_by_rank, aes(rank, term_freq,
color="Log(freq) vs. Log(r)")) +
geom_line(size = 1.6, alpha = 0.8, colour="red") +
geom_point(colour="red", alpha=0, size=1) +
geom_text(data=freq_by_rank[get_x,],
aes(rank, term_freq,label=word, colour="black"), colour="black")+
labs(title="Checking text document against Zipf's law")+
scale_x_log10() +
scale_y_log10() +
xlab("log(Rank)") +
ylab("log(Term frequency)")+
#theme(legend.position = "top")
geom_abline(intercept = as.numeric(int_slope$coefficients[1]),
slope = as.numeric(int_slope$coefficients[2]),
color = c("gray40"), linetype = 2, size=1.2) +
theme_light()+
scale_shape_manual(values = 1) +
labs(shape = "", linetype = "") +
theme(panel.border = element_rect(colour = "black", fill=NA),
aspect.ratio = 1, axis.text = element_text(colour = 1, size = 12))
ggplot(freq_by_rank, aes(rank, term_freq,
color="Log(freq) vs. Log(r)")) +
geom_line(size = 1.6, alpha = 0.8, colour="red") +
geom_point(colour="red", alpha=0, size=1) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 10)) +
geom_text(data=freq_by_rank[idx,],
aes(rank, term_freq,label=word))+
labs(title="Checking text document against Zipf's law")+
scale_x_log10() +
scale_y_log10()
ggplot(freq_by_rank, aes(rank, term_freq,
color="Log(freq) vs. Log(r)")) +
geom_line(size = 1.6, alpha = 0.8, colour="red") +
geom_point(colour="red", alpha=0, size=1) +
geom_text(data=freq_by_rank[get_x,],
aes(rank, term_freq,label=word, colour="black"),
colour="black", position = position_nudge(y = 0.01))+
labs(title="Checking text document against Zipf's law")+
scale_x_log10() +
scale_y_log10() +
xlab("log(Rank)") +
ylab("log(Term frequency)")+
#theme(legend.position = "top")
geom_abline(intercept = as.numeric(int_slope$coefficients[1]),
slope = as.numeric(int_slope$coefficients[2]),
color = c("gray40"), linetype = 2, size=1.2) +
theme_light()+
scale_shape_manual(values = 1) +
labs(shape = "", linetype = "") +
theme(panel.border = element_rect(colour = "black", fill=NA),
aspect.ratio = 1, axis.text = element_text(colour = 1, size = 12))
ggplot(freq_by_rank, aes(rank, term_freq,
color="Log(freq) vs. Log(r)")) +
geom_line(size = 1.6, alpha = 0.8, colour="red") +
geom_point(colour="red", alpha=0, size=1) +
geom_text(data=freq_by_rank[get_x,],
aes(rank, term_freq,label=word, colour="black"),
colour="black", position = position_nudge(y = 0.1))+
labs(title="Checking text document against Zipf's law")+
scale_x_log10() +
scale_y_log10() +
xlab("log(Rank)") +
ylab("log(Term frequency)")+
#theme(legend.position = "top")
geom_abline(intercept = as.numeric(int_slope$coefficients[1]),
slope = as.numeric(int_slope$coefficients[2]),
color = c("gray40"), linetype = 2, size=1.2) +
theme_light()+
scale_shape_manual(values = 1) +
labs(shape = "", linetype = "") +
theme(panel.border = element_rect(colour = "black", fill=NA),
aspect.ratio = 1, axis.text = element_text(colour = 1, size = 12))
ggplot(freq_by_rank, aes(rank, term_freq,
color="Log(freq) vs. Log(r)")) +
geom_line(size = 1.6, alpha = 0.8, colour="red") +
geom_point(colour="red", alpha=0, size=1) +
geom_text(data=freq_by_rank[get_x,],
aes(rank, term_freq,label=word, colour="black"),
colour="black", position = position_nudge(y = 0.5))+
labs(title="Checking text document against Zipf's law")+
scale_x_log10() +
scale_y_log10() +
xlab("log(Rank)") +
ylab("log(Term frequency)")+
#theme(legend.position = "top")
geom_abline(intercept = as.numeric(int_slope$coefficients[1]),
slope = as.numeric(int_slope$coefficients[2]),
color = c("gray40"), linetype = 2, size=1.2) +
theme_light()+
scale_shape_manual(values = 1) +
labs(shape = "", linetype = "") +
theme(panel.border = element_rect(colour = "black", fill=NA),
aspect.ratio = 1, axis.text = element_text(colour = 1, size = 12))
ggplot(freq_by_rank, aes(rank, term_freq,
color="Log(freq) vs. Log(r)")) +
geom_line(size = 1.6, alpha = 0.8, colour="red") +
geom_point(colour="red", alpha=0, size=1) +
geom_text(data=freq_by_rank[get_x,],
aes(rank, term_freq,label=word, colour="black"),
colour="black", position = position_nudge(y = 0.35))+
labs(title="Checking text document against Zipf's law")+
scale_x_log10() +
scale_y_log10() +
xlab("log(Rank)") +
ylab("log(Term frequency)")+
#theme(legend.position = "top")
geom_abline(intercept = as.numeric(int_slope$coefficients[1]),
slope = as.numeric(int_slope$coefficients[2]),
color = c("gray40"), linetype = 2, size=1.2) +
theme_light()+
scale_shape_manual(values = 1) +
labs(shape = "", linetype = "") +
theme(panel.border = element_rect(colour = "black", fill=NA),
aspect.ratio = 1, axis.text = element_text(colour = 1, size = 12))
